<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>កម្មវិធីបង្កើតរបាយការណ៍វត្តមាន</title>
    <!-- ភ្ជាប់ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ភ្ជាប់ Google Font សម្រាប់ភាសាខ្មែរ (Kantumruy Pro) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kantumruy+Pro:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    
    <style>
        /* កំណត់ Font គោលសម្រាប់កម្មវិធីទាំងមូល */
        body {
            font-family: 'Kantumruy Pro', sans-serif;
            background-color: #f4f7f6;
        }
        /* លាក់ព្រួញសម្រាប់ input type number (ទោះបីយើងមិនប្រើ តែល្អសម្រាប់ពេលក្រោយ) */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        /* រចនាប័ទ្មសម្រាប់ spinner */
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* --- រចនាប័ទ្មសម្រាប់ Print --- */
        @media print {
            /* លាក់ធាតុដែលមិនត្រូវបោះពុម្ព */
            body > .max-w-5xl > *:not(#report-output) {
                display: none;
            }
            .no-print {
                display: none !important;
            }

            /* កំណត់ Body និង Container សម្រាប់ Print */
            body, .max-w-5xl {
                padding: 0 !important;
                margin: 0 !important;
                background-color: #ffffff !important;
                box-shadow: none !important;
                border: none !important;
            }

            /* កំណត់ផ្នែករបាយការណ៍ */
            #report-output {
                display: block !important;
                margin: 0 !important;
                padding: 1cm !important; /* បន្ថែមគែមសម្រាប់ក្រដាស */
                box-shadow: none !important;
                border: none !important;
                max-width: 100% !important;
            }
            
            h1, h2, p, span {
                color: #000000 !important;
            }

            /* ធានាថាតារាងមើលទៅស្អាតពេល Print */
            table {
                width: 100% !important;
                border-collapse: collapse !important;
            }
            thead {
                background-color: #f0f0f0 !important;
                display: table-header-group; /* ធានាថា Header ជាប់រាល់ទំព័រ */
            }
            th, td {
                border: 1px solid #999 !important;
                padding: 8px !important;
                color: #000000 !important;
            }
            /* លុបផ្ទៃខាងក្រោយឆ្លាស់គ្នា */
            tbody tr {
                background-color: #ffffff !important;
            }
            /* ជៀសវាងការកាត់ផ្តាច់ព័ត៌មានសង្ខេប */
            #employee-summary {
                page-break-inside: avoid;
                background-color: #f9f9f9 !important;
                border: 1px solid #ccc !important;
            }
            
            #no-records {
                display: none; /* លាក់សារ "មិនមានទិន្នន័យ" ពេល Print បើមាន */
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-5xl mx-auto bg-white rounded-xl shadow-xl p-6 md:p-10">
        
        <!-- បឋម -->
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
            របាយការណ៍វត្តមានបុគ្គលិក
        </h1>
        <p class="text-base text-gray-600 mb-8">
            បង្កើតរបាយការណ៍លម្អិតដោយទាញទិន្នន័យពី Google Sheets។
        </p>

        <!-- ផ្នែកកំណត់ API Key -->
        <div class="mb-8 p-5 bg-blue-50 border border-blue-200 rounded-lg">
            <label for="api-key" class="block text-sm font-semibold text-blue-800 mb-2">
                <span class="text-red-600">*</span> ជំហានទី១៖ បញ្ចូល Google Sheets API Key
            </label>
            <input type="password" id="api-key" placeholder="បិទភ្ជាប់ API Key របស់អ្នកនៅទីនេះ"
                   class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <p class="text-xs text-gray-600 mt-2">
                កម្មវិធីនេះត្រូវការ API Key ដើម្បីទាញទិន្នន័យពី Google Sheet។ ទិន្នន័យ Sheet ត្រូវតែកំណត់ជាសាធារណៈ (Public)។
            </p>
        </div>

        <!-- ផ្នែកបញ្ជា (Controls) -->
        <h2 class="text-lg font-semibold text-gray-700 mb-3">ជំហានទី២៖ កំណត់ការស្វែងរក</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <!-- ជ្រើសរើសបុគ្គលិក -->
            <div>
                <label for="employee-input" class="block text-sm font-medium text-gray-700 mb-1">
                    ជ្រើសរើសបុគ្គលិក (វាយ ID ឬ ឈ្មោះ)
                </label>
                <input type="text" id="employee-input" list="employee-list" 
                       placeholder="វាយដើម្បីស្វែងរក..."
                       class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" disabled>
                <datalist id="employee-list"></datalist>
            </div>
            
            <!-- ជ្រើសរើសថ្ងៃចាប់ផ្ដើម -->
            <div>
                <label for="start-date" class="block text-sm font-medium text-gray-700 mb-1">
                    ចាប់ពីថ្ងៃទី
                </label>
                <input type="date" id="start-date" 
                       class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- ជ្រើសរើសថ្ងៃបញ្ចប់ -->
            <div>
                <label for="end-date" class="block text-sm font-medium text-gray-700 mb-1">
                    ដល់ថ្ងៃទី
                </label>
                <input type="date" id="end-date" 
                       class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            </div>
        </div>

        <!-- ប៊ូតុងបង្កើតរបាយការណ៍ -->
        <div class="flex flex-col md:flex-row gap-4 border-t pt-6 mt-6">
             <button id="fetch-button" 
                    class="w-full md:w-1/2 bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                 ១. ទាញទិន្នន័យបុគ្គលិក
             </button>
            <button id="generate-button" 
                    class="w-full md:w-1/2 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out" disabled>
                ២. បង្កើតរបាយការណ៍
            </button>
        </div>

        <!-- កន្លែងបង្ហាញ Error ឬ Loading -->
        <div id="message-box" class="mt-6 hidden">
            <!-- Spinner -->
            <div id="loader" class="hidden justify-center items-center">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mr-3"></div>
                <span class="text-gray-600">កំពុងទាញទិន្នន័យ...</span>
            </div>
            <!-- Error -->
            <div id="error-message" class="hidden p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
                <!-- ខ្លឹមសារ Error នឹងបង្ហាញនៅទីនេះ -->
            </div>
        </div>

        <!-- ផ្នែកបង្ហាញលទ្ធផល (របាយការណ៍) -->
        <div id="report-output" class="mt-10 hidden">

            <!-- ប៊ូតុង Print/PDF -->
            <div class="flex justify-between items-center mb-6">
                 <h2 class="text-xl md:text-2xl font-bold text-gray-800 border-b-2 border-blue-200 pb-2 flex-grow">
                    របាយការណ៍លម្អិត
                </h2>
                <button id="print-button" 
                        onclick="window.print()"
                        class="no-print ml-6 bg-gray-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition duration-150 ease-in-out flex items-center shrink-0">
                    <!-- SVG Icon for Print -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h1v3a1 1 0 001 1h8a1 1 0 001-1v-3h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a1 1 0 00-1-1H6a1 1 0 00-1 1zM6 4h8v3H6V4zm8 12H6v-3h8v3zm-1-6H7v-2h6v2z" clip-rule="evenodd"></path>
                    </svg>
                    ទាញយក PDF / បោះពុម្ព
                </button>
            </div>

            <!-- ព័ត៌មានសង្ខេបរបស់បុគ្គលិក -->
            <div id="employee-summary" 
                 class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-4 p-6 bg-gray-50 rounded-lg shadow-sm mb-8 border border-gray-200">
                <!-- ព័ត៌មានបុគ្គលិកនឹងបង្ហាញនៅទីនេះ -->
            </div>

            <!-- តារាងលម្អិតវត្តមាន -->
            <div class="overflow-x-auto shadow-md rounded-lg">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                ល.រ
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                កាលបរិច្ឆេទ
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                កាលវិភាគ
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                ម៉ោងចូល
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider">
                                ម៉ោងចេញ
                            </th>
                        </tr>
                    </thead>
                    <tbody id="report-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- ទិន្នន័យវត្តមាននឹងបង្ហាញនៅទីនេះ -->
                    </tbody>
                </table>
            </div>
            
            <div id="no-records" class="hidden text-center p-6 bg-gray-50 rounded-lg mt-4">
                <p class="text-gray-600">មិនមានទិន្នន័យវត្តមានសម្រាប់បុគ្គលិកនេះ ក្នុងចន្លោះកាលបរិច្ឆេទដែលបានជ្រើសរើសទេ។</p>
            </div>
        </div>
    </div>

    <script>
        // --- ផ្នែកកំណត់ค่าអចិន្ត្រៃយ៍ ---
        const SHEET_ID = '14eA00GXamqLkhuLAzVYPOBKads7XUZ5mfVRyqSGQwfk';
        const SHEET_NAME = 'Data';
        // យើងនឹងទាញទិន្នន័យពីជួរ B ដល់ K
        const DATA_RANGE = `${SHEET_NAME}!B2:K`; 

        // --- ផ្នែករក្សាទុកទិន្នន័យដែលបានទាញមក ---
        let allData = []; // រក្សាទុកទិន្នន័យឆៅទាំងអស់ពី Sheet
        let employeeMap = new Map(); // រក្សាទុកព័ត៌មានបុគ្គលិក (Unique)

        // --- ផ្នែកយោងទៅធាតុ DOM ---
        const apiKeyInput = document.getElementById('api-key');
        const employeeInput = document.getElementById('employee-input');
        const employeeList = document.getElementById('employee-list');
        const startDateInput = document.getElementById('start-date');
        const endDateInput = document.getElementById('end-date');
        const fetchButton = document.getElementById('fetch-button');
        const generateButton = document.getElementById('generate-button');
        
        const messageBox = document.getElementById('message-box');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('error-message');
        
        const reportOutput = document.getElementById('report-output');
        const employeeSummary = document.getElementById('employee-summary');
        const reportTableBody = document.getElementById('report-table-body');
        const noRecordsMessage = document.getElementById('no-records');

        // --- មុខងារ Helper (ជំនួយ) ---

        /**
         * បង្ហាញសារ Error
         * @param {string} message - ខ្លឹមសារ Error
         */
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
            loader.classList.add('hidden');
            messageBox.classList.remove('hidden');
        }

        /**
         * បង្ហាញ Spinner ពេលកំពុងដំណើរការ
         */
        function showLoader() {
            errorMessage.classList.add('hidden');
            loader.style.display = 'flex'; // ប្រើ style.display ព្រោះ Tailwind class 'flex' ត្រូវ set ដោយផ្ទាល់
            loader.classList.remove('hidden');
            messageBox.classList.remove('hidden');
            reportOutput.classList.add('hidden'); // លាក់លទ្ធផលចាស់
        }

        /**
         * លាក់ Spinner និង Error
         */
        function hideMessages() {
            messageBox.classList.add('hidden');
            loader.classList.add('hidden');
            errorMessage.classList.add('hidden');
        }

        /**
         * បំប្លែងកាលបរិច្ឆេទពីទម្រង់ "1-Aug-2025" ទៅជា Object Date
         * @param {string} dateString - កាលបរិច្ឆេទជាអត្ថបទ (ឧ. 1-Aug-2025)
         * @returns {Date | null} - Object Date ឬ null បើទម្រង់ខុស
         */
        function parseSheetDate(dateString) {
            if (!dateString) return null;
            
            const months = {
                'Jan': 0, 'Feb': 1, 'Mar': 2, 'Apr': 3, 'May': 4, 'Jun': 5,
                'Jul': 6, 'Aug': 7, 'Sep': 8, 'Oct': 9, 'Nov': 10, 'Dec': 11
            };
            
            const parts = dateString.split('-'); // ["1", "Aug", "2025"]
            if (parts.length !== 3) return null;
            
            const day = parseInt(parts[0], 10);
            const month = months[parts[1]];
            const year = parseInt(parts[2], 10);
            
            if (isNaN(day) || month === undefined || isNaN(year)) return null;
            
            // កំណត់ម៉ោង 00:00:00 ដើម្បីងាយស្រួលប្រៀបធៀប
            return new Date(year, month, day, 0, 0, 0); 
        }

        // --- មុខងារស្នូល (Core Functions) ---

        /**
         * ទាញទិន្នន័យទាំងអស់ពី Google Sheet
         */
        async function fetchSheetData() {
            const apiKey = apiKeyInput.value.trim();
            if (!apiKey) {
                showError('សូមបញ្ចូល API Key ជាមុនសិន។');
                return;
            }

            showLoader();
            allData = [];
            employeeMap.clear();
            employeeList.innerHTML = ''; // សម្អាត Datalist ចាស់

            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${DATA_RANGE}?key=${apiKey}`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || 'មិនអាចទាញទិន្នន័យបានទេ។ សូមពិនិត្យ API Key ឬ Sheet ID។');
                }

                const data = await response.json();
                const values = data.values;

                if (!values || values.length === 0) {
                    showError('រកមិនឃើញទិន្នន័យនៅក្នុង Sheet ទេ។');
                    return;
                }

                // ចាប់ផ្ដើមដំណើរការទិន្នន័យ
                values.forEach(row => {
                    // Mapping តាមជួរឈរដែលបានស្នើ B=0, C=1, D=2, E=3, F=4, G=5, H=6, I=7, J=8, K=9
                    const record = {
                        group: row[0] || '',     // B
                        class: row[1] || '',     // C
                        department: row[2] || '',// D
                        name: row[3] || '',      // E
                        gender: row[4] || '',    // F
                        id: row[5] || '',        // G
                        date: row[6] || '',      // H
                        schedule: row[7] || '',  // I
                        timeIn: row[8] || '',    // J
                        timeOut: row[9] || ''    // K
                    };

                    // បន្ថែមទៅក្នុងទិន្នន័យសរុប
                    if(record.id && record.name && record.date) {
                        allData.push(record);

                        // បង្កើត Unique List សម្រាប់បុគ្គលិក
                        const employeeKey = `${record.id} - ${record.name}`;
                        if (!employeeMap.has(employeeKey)) {
                            employeeMap.set(employeeKey, {
                                id: record.id,
                                name: record.name,
                                gender: record.gender,
                                group: record.group,
                                department: record.department,
                                class: record.class
                            });
                        }
                    }
                });
                
                // បញ្ចូលទិន្នន័យទៅក្នុង Datalist
                populateDatalist();
                hideMessages();
                
                // បើកឲ្យប្រើប្រាស់ Input និងប៊ូតុងបង្កើតរបាយការណ៍
                employeeInput.disabled = false;
                generateButton.disabled = false;
                fetchButton.textContent = "ទាញទិន្នន័យឡើងវិញ";
                
                // បង្ហាញសារជោគជ័យបណ្ដោះអាសន្ន
                messageBox.classList.remove('hidden');
                errorMessage.classList.remove('hidden');
                errorMessage.classList.replace('bg-red-100', 'bg-green-100');
                errorMessage.classList.replace('border-red-400', 'border-green-400');
                errorMessage.classList.replace('text-red-700', 'text-green-700');
                errorMessage.textContent = `ទាញទិន្នន័យបាន ${allData.length} កំណត់ត្រា និង ${employeeMap.size} បុគ្គលិក។`;
                
                setTimeout(hideMessages, 3000); // លាក់សារជោគជ័យ
                
            } catch (error) {
                showError(`Error: ${error.message}`);
                console.error('Fetch Error:', error);
            }
        }

        /**
         * បញ្ចូលឈ្មោះបុគ្គលិកទៅក្នុង <datalist>
         */
        function populateDatalist() {
            employeeList.innerHTML = ''; // សម្អាត
            for (const key of employeeMap.keys()) {
                const option = document.createElement('option');
                option.value = key;
                employeeList.appendChild(option);
            }
        }

        /**
         * បង្កើត និងបង្ហាញរបាយការណ៍
         */
        function generateReport() {
            const selectedEmployeeKey = employeeInput.value;
            const startDate = startDateInput.value;
            const endDate = endDateInput.value;

            // --- ពិនិត្យ Input ---
            if (!selectedEmployeeKey || !employeeMap.has(selectedEmployeeKey)) {
                showError('សូមជ្រើសរើសបុគ្គលិកពីក្នុងបញ្ជី។');
                return;
            }
            if (!startDate || !endDate) {
                showError('សូមជ្រើសរើសចន្លោះកាលបរិច្ឆេទ (ថ្ងៃចាប់ផ្ដើម និង ថ្ងៃបញ្ចប់)។');
                return;
            }

            const start = new Date(startDate);
            const end = new Date(endDate);
            
            // កំណត់ម៉ោងឲ្យត្រូវ ដើម្បីប្រៀបធៀប
            start.setHours(0, 0, 0, 0);
            end.setHours(23, 59, 59, 999); 

            if (start > end) {
                showError('ថ្ងៃចាប់ផ្ដើម មិនអាចធំជាងថ្ងៃបញ្ចប់បានទេ។');
                return;
            }

            hideMessages();
            
            // --- ដំណើរការទិន្នន័យ ---
            const employeeInfo = employeeMap.get(selectedEmployeeKey);
            
            //  lọc (Filter) ទិន្នន័យវត្តមាន
            const records = allData.filter(record => {
                const recordDate = parseSheetDate(record.date);
                if (!recordDate) return false; // រំលងបើថ្ងៃខែទម្រង់ខុស
                
                return record.id === employeeInfo.id &&
                       record.name === employeeInfo.name &&
                       recordDate >= start &&
                       recordDate <= end;
            });
            
            // --- បង្ហាញលទ្ធផល ---
            renderReport(employeeInfo, records);
        }

        /**
         * បង្ហាញលទ្ធផលទៅលើ UI
         * @param {object} info - ព័ត៌មានបុគ្គលិក
         * @param {array} records - បញ្ជីវត្តមានដែលបាន lọc រួច
         */
        function renderReport(info, records) {
            // 1. បង្ហាញព័ត៌មានសង្ខេប
            employeeSummary.innerHTML = `
                <div class="col-span-1 sm:col-span-2 md:col-span-3">
                    <p class="text-lg font-bold text-blue-800">${info.name}</p>
                    <p class="text-sm text-gray-600">អត្តលេខ: ${info.id}</p>
                </div>
                <div>
                    <span class="text-xs font-semibold text-gray-500 block">ភេទ</span>
                    <span class="text-sm font-medium text-gray-800">${info.gender || 'N/A'}</span>
                </div>
                <div>
                    <span class="text-xs font-semibold text-gray-500 block">ក្រុម</span>
                    <span class="text-sm font-medium text-gray-800">${info.group || 'N/A'}</span>
                </div>
                <div>
                    <span class="text-xs font-semibold text-gray-500 block">ផ្នែក</span>
                    <span class="text-sm font-medium text-gray-800">${info.department || 'N/A'}</span>
                </div>
                <div>
                    <span class="text-xs font-semibold text-gray-500 block">ថ្នាក់</span>
                    <span class="text-sm font-medium text-gray-800">${info.class || 'N/A'}</span>
                </div>
            `;

            // 2. បង្ហាញតារាងលម្អិត
            reportTableBody.innerHTML = ''; // សម្អាតតារាងចាស់
            
            if (records.length === 0) {
                noRecordsMessage.classList.remove('hidden');
            } else {
                noRecordsMessage.classList.add('hidden');
                
                // តម្រៀបតាមកាលបរិច្ឆេទ ពីចាស់ទៅថ្មី
                records.sort((a, b) => parseSheetDate(a.date) - parseSheetDate(b.date));
                
                records.forEach((record, index) => {
                    const row = document.createElement('tr');
                    row.className = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            ${index + 1}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                            ${record.date}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                            ${record.schedule || ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                            ${record.timeIn || 'N/A'}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                            ${record.timeOut || 'N/A'}
                        </td>
                    `;
                    reportTableBody.appendChild(row);
                });
            }
            
            // 3. បង្ហាញផ្នែកលទ្ធផលទាំងមូល
            reportOutput.classList.remove('hidden');
            
            // រំកិលអេក្រង់ទៅមើលលទ្ធផល
            reportOutput.scrollIntoView({ behavior: 'smooth' });
        }
        
        // --- ភ្ជាប់ Event Listeners ---
        fetchButton.addEventListener('click', fetchSheetData);
        generateButton.addEventListener('click', generateReport);
        
        // កំណត់ថ្ងៃខែ Default (ឧ. ដើមខែ និង ថ្ងៃបច្ចុប្បន្ន)
        const today = new Date();
        const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
        
        startDateInput.value = firstDayOfMonth.toISOString().split('T')[0];
        endDateInput.value = today.toISOString().split('T')[0];

    </script>

</body>
</html>

